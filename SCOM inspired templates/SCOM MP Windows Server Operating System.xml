<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.0</version>
    <date>2020-11-18T09:49:19Z</date>
    <groups>
        <group>
            <name>WindowsTemplates</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>SCOM MP Windows Server Operating System</template>
            <name>SCOM MP Windows Server Operating System</name>
            <description>http://systemcentercore.com/?GetCategory=Windows+Server+Operating+System</description>
            <groups>
                <group>
                    <name>WindowsTemplates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Logical Disk</name>
                </application>
                <application>
                    <name>Maintenance</name>
                </application>
                <application>
                    <name>Network Interface</name>
                </application>
                <application>
                    <name>Operating System</name>
                </application>
                <application>
                    <name>Physical Disk</name>
                </application>
                <application>
                    <name>Processor Information</name>
                </application>
                <application>
                    <name>Windows Defender</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Zabbix Agent Ping</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>agent.ping</key>
                    <description>SCOM MP has no provisions to detect system down, this is a workaround.</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{nodata(10m)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(10m)}=1</recovery_expression>
                            <name>Zabbix Agent Unreachable</name>
                            <priority>HIGH</priority>
                            <description>Trigger set to 10 minutes. This reduces noise when restarting while .Net libraries need to be compiled.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service or Driver Failed to Start</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,&quot;Service Control Manager&quot;,7000|7001|7008|7022|7023|7026|7035|7038|7041,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ServiceOrDriverFailedToStart.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{nodata(24h)}=0</expression>
                            <name>Service or driver failed to start</name>
                            <priority>WARNING</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ServiceOrDriverFailedToStart.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0&#13;
This trigger can be noisy if you have autoloading drivers with no hardware attached, such as &quot;cdrom&quot;. Please set such drivers to autoload instead of boot critical.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service is misconfigured</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,&quot;Service Control Manager&quot;,7015|7017|7018|7019|7020,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ServiceMisconfigured.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{nodata(24h)}=0</expression>
                            <name>Service is misconfigured</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ServiceMisconfigured.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service Terminated Unexpectedly</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,&quot;Service Control Manager&quot;,7021|7024|7031|7032|7033|7034,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ServiceTerminatedUnexpextedly.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{nodata(24h)}=0</expression>
                            <name>Service terminated unexpectedly</name>
                            <priority>WARNING</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ServiceTerminatedUnexpextedly.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service has Entered into an Unpredictable State</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,&quot;Service Control Manager&quot;,7030|7037,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ServiceEnteredUnpredictableState.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{nodata(24h)}=0</expression>
                            <name>Service entered unpredictable state</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ServiceEnteredUnpredictableState.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Windows BugCheck Restart Events</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,BugCheck,1000|1001,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.RebootFromBugCheck.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0&#13;
&#13;
For some strange reason Agent doesn't see these events (eventlog[System,,,BugCheck,1000|1001,,]) so must check with PS. Maybe agent doesn't check for events before agent was started...?</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Disk can not be read</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,disk,31,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.LDMCantReadDisk.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{nodata(24h)}=0</expression>
                            <name>LDM - Can't Read Disk</name>
                            <priority>WARNING</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.LDMCantReadDisk.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Storport Miniport Driver Timed Out Monitor</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,Disk,^153$,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.StorportMiniportDriver.Timedout.153.Monitor&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.1.0.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{nodata(24h)}=0</expression>
                            <name>Windows Storport Miniport Driver has timed out a request</name>
                            <url>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.StorportMiniportDriver.Timedout.153.Monitor&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.1.0.0</url>
                            <priority>HIGH</priority>
                            <description>The Windows Storport Miniport Driver has timed out a request on the server {HOST.NAME}</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>NTFS - Delayed Write Lost</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,Disk|ntfs,11|50,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.NTFSDelayedWriteLost.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{nodata(24h)}=0</expression>
                            <name>NTFS - Delayed Write Lost</name>
                            <priority>WARNING</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.NTFSDelayedWriteLost.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>NTFS - File System Corrupt</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,Disk|ntfs,^(41|55)$,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.NTFSFileSystemCorrupt.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{nodata(24h)}=0</expression>
                            <name>NTFS - File System Corrupt</name>
                            <priority>WARNING</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.NTFSFileSystemCorrupt.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Windows Clean Restart Events</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,EventLog,6005|6006,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.CleanShutdown.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0&#13;
https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.RestartEvent.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Windows Dirty Shutdown Events</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,EventLog,6008,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.DirtyShutdown.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0&#13;
&#13;
Agent doesn't see these events (eventlog[System,,,EventLog,6008,,]) for some reason so query PS manually</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Event Log File is Full</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,EventLog,^6000$,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.EventLogFull.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{nodata(24h)}=0</expression>
                            <name>Event log is full</name>
                            <priority>WARNING</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.EventLogFull.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Performance registry corruption</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,Microsoft-Windows-LoadPerf,2007|3002|3015,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.PerformanceRegistryCorruption.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{nodata(24h)}=0</expression>
                            <name>Performance registry corruption</name>
                            <priority>WARNING</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.PerformanceRegistryCorruption.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Too many requests for performance counter data have failed</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,Microsoft-Windows-Perflib,1015,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.PerfCounterDataRequestTimeOut.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{nodata(24h)}=0</expression>
                            <name>Too many requests for performance counter data have timed out</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.PerfCounterDataRequestTimeOut.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Duplicate IP Address has been Detected</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,Microsoft-Windows-TCPIP,^(4198|4199)$,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.IPAddressConflict.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{nodata(24h)}=0</expression>
                            <name>IP address conflict</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.IPAddressConflict.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Software Updates Installation Events</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,Microsoft-Windows-WindowsUpdateClient,18|19,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.SoftwareUpdatesInstalled.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0&#13;
https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.SoftwareUpdatesScheduledForInstallation.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Software Update Installation Failed</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,Microsoft-Windows-WindowsUpdateClient,20,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.SoftwareUpdateInstallationFailed.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{nodata(24h)}=0</expression>
                            <name>Software update installation failed</name>
                            <priority>AVERAGE</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.SoftwareUpdateInstallationFailed.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Checking File System Occurred on Startup</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,Microsoft-Windows-WinInit,^1001$,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.CheckingFileSystemOccuredOnStartup.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>NTFS Quota Threshold Reached</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,Ntfs,^(36|40)$,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.NTFSQuotaThresholdLimitReached.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0&#13;
https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.NTFSQuotaThresholdReached.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Server Service Configuration Health</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,Server,2506,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ServerServiceConfiguration.Rule&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{nodata(24h)}=0</expression>
                            <name>Server Service is misconfigured</name>
                            <priority>WARNING</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ServerServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Share Configuration is Invalid</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,Server,2507|2511,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ShareConfigurationInvalid.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{nodata(24h)}=0</expression>
                            <name>Share configuration is invalid</name>
                            <priority>WARNING</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ShareConfigurationInvalid.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Network Adapter was Disconnected from the Network</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,,tcpip,4202,,skip]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>LOG</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.NetworkAdapterDisconnected.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Percent Memory Used</name>
                    <type>CALCULATED</type>
                    <key>PercentMemoryUsed</key>
                    <delay>15m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>100-(100*last(&quot;perf_counter[\&quot;\Memory\Available Bytes\&quot;,900]&quot;)/last(&quot;wmi.get[root\cimv2,Select TotalPhysicalMemory from Win32_ComputerSystem]&quot;))</params>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.PercentMemoryUsed.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Cache Data Map Hits Percent</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Cache\Data Map Hits %&quot;,300]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.CacheDataMapHitsPercent.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Available Megabytes of Memory</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Memory\Available Bytes&quot;,900]</key>
                    <delay>15m</delay>
                    <value_type>FLOAT</value_type>
                    <units>B</units>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryAvailableMBytes&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{max({$SCOMMPWSOS_OS_MEMAMB_NS})}&lt;{$SCOMMPWSOS_OS_MEMAMB_TH}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{max({$SCOMMPWSOS_OS_MEMAMB_NS})}&gt;({$SCOMMPWSOS_OS_MEMAMB_TH}*{$SCOMMPWSOS_OS_MEMAMB_RE})</recovery_expression>
                            <name>Available Megabytes of Memory is too low</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryAvailableMBytes&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Cache Bytes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Memory\Cache Bytes&quot;,600]</key>
                    <delay>10m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>B</units>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryCacheBytes.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Commit Limit</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Memory\Commit Limit&quot;,600]</key>
                    <delay>10m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>B</units>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryCommitLimit.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Committed Bytes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Memory\Committed Bytes&quot;,600]</key>
                    <delay>10m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>B</units>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryCommittedBytes.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Memory Page Reads per Second</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Memory\Page Reads/sec&quot;,300]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryPageReadsPerSec.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Pages Input Per Second</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Memory\Pages Input/sec&quot;,600]</key>
                    <delay>10m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryPagesInputPerSec.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Pages Output Per Second</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Memory\Pages Output/sec&quot;,600]</key>
                    <delay>10m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryPagesOutputPerSec.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Memory Page Writes per Second</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Memory\Page Writes/sec&quot;,300]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryPageWritesPerSec.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Pool Paged Resident Bytes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Memory\Pool Paged Resident Bytes&quot;,600]</key>
                    <delay>10m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>B</units>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryPoolPagedResidentBytes.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>System Cache Resident Bytes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Memory\System Cache Resident Bytes&quot;,600]</key>
                    <delay>10m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>B</units>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemorySystemCacheResidentBytes.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Page File Percentage Use</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Paging File(_Total)\% Usage&quot;,600]</key>
                    <delay>10m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.PageFilePercentUsage.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Total DPC Time Percentage</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Processor(_Total)\% DPC Time&quot;,120]</key>
                    <delay>2m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.TotalDPCTime&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{min(#5)}&gt;95</expression>
                            <name>Total DPC Time Percentage is too high</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.TotalDPCTime&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Total Percentage Interrupt Time</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Processor(_Total)\% Interrupt Time&quot;,120]</key>
                    <delay>2m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.TotalPercentInterruptTime&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{min(#5)}&gt;10</expression>
                            <name>Total Percentage Interrupt Time is too high</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.TotalPercentInterruptTime&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>System Context Switches per Second</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\System\Context Switches/sec&quot;,300]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.SystemContextSwitchesPerSec.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Percentage of Committed Memory in Use</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\Memory\% Committed Bytes In Use&quot;,120]</key>
                    <delay>2m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.PercentCommittedBytesInUse&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{min({$SCOMMPWSOS_OS_PERCMEMU_NS})}&gt;{$SCOMMPWSOS_OS_PERCMEMU_TH}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min({$SCOMMPWSOS_OS_PERCMEMU_NS})}&lt;({$SCOMMPWSOS_OS_PERCMEMU_TH}*{$SCOMMPWSOS_OS_PERCMEMU_RE})</recovery_expression>
                            <name>Percentage of Committed Memory in Use is too high</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.PercentCommittedBytesInUse&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Free System Page Table Entries</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\Memory\Free System Page Table Entries&quot;,300]</key>
                    <delay>5m</delay>
                    <value_type>FLOAT</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryFreeSystemPageTableEntries&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;5000</expression>
                            <name>Free System Page Table Entries is too Low</name>
                            <priority>WARNING</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryFreeSystemPageTableEntries&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Memory Pages Per Second</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\Memory\Pages/sec&quot;,300]</key>
                    <delay>5m</delay>
                    <value_type>FLOAT</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryPagesPerSecond&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{min({$SCOMMPWSOS_OS_MEMPPS_NS})}&gt;{$SCOMMPWSOS_OS_MEMPPS_TH}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min({$SCOMMPWSOS_OS_MEMPPS_NS})}&lt;({$SCOMMPWSOS_OS_MEMPPS_TH}/{$SCOMMPWSOS_OS_MEMPPS_RE})</recovery_expression>
                            <name>Memory Pages Per Second is too High</name>
                            <priority>WARNING</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryPagesPerSecond&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Memory Pool Non-paged Bytes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\Memory\Pool Nonpaged Bytes&quot;,600]</key>
                    <delay>10m</delay>
                    <value_type>FLOAT</value_type>
                    <units>B</units>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryPoolNonPagedBytes.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Memory Pool Paged Bytes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\Memory\Pool Paged Bytes&quot;,600]</key>
                    <delay>10m</delay>
                    <value_type>FLOAT</value_type>
                    <units>B</units>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.MemoryPoolPagedBytes.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Max Concurrent API Semaphore Timeouts Monitor</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\Netlogon(_Total)\Semaphore Timeouts&quot;,900]</key>
                    <delay>15m</delay>
                    <value_type>FLOAT</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.MaxConcurrentAPI.Monitor&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Max Concurrent API Semaphore Waiters Monitor</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\Netlogon(_Total)\Semaphore Waiters&quot;,900]</key>
                    <delay>15m</delay>
                    <value_type>FLOAT</value_type>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.MaxConcurrentAPI.Monitor&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Processor Percentage Time Total</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\Processor(_Total)\% Processor Time&quot;,120]</key>
                    <delay>2m</delay>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <description>Helper for CPU usage trigger</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>System Processor Queue Length</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\System\Processor Queue Length&quot;,120]</key>
                    <delay>2m</delay>
                    <value_type>FLOAT</value_type>
                    <description>Helper for CPU usage trigger</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>TCPv4 Connection Failures</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\TCPv4\Connection Failures&quot;]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>TCPv4 Connections Established</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\TCPv4\Connections Established&quot;]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>TCPv4 Connections Reset</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\TCPv4\Connections Reset&quot;]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>TCPv4 Segments Received Per Second</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\TCPv4\Segments Received/sec&quot;,300]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{min({$SCOMMPWSOS_OS_TCPV4_SRXS_NS})}&gt;={$SCOMMPWSOS_OS_TCPV4_SRXS_TH}</expression>
                            <name>TCPv4 Segments Received Per Second is too high</name>
                            <url>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.TCPv4.SegmentsReceivedPerSec&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.1.0.0</url>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <description>The threshold for the TCPv4\Segments Received/sec performance counter has been exceeded</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TCPv4 Segments Retransmitted Per Second</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\TCPv4\Segments Retransmitted/sec&quot;,300]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{min({$SCOMMPWSOS_OS_TCPV4_SRTXS_NS})}&gt;={$SCOMMPWSOS_OS_TCPV4_SRTXS_TH}</expression>
                            <name>TCPv4 Segments Retransmitted Per Second is too high</name>
                            <url>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.TCPv4.SegmentsRetransmittedPerSec&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.1.0.0</url>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <description>The threshold for the TCPv4\Segments Retransmitted/sec performance counter has been exceeded.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TCPv4 Segments Sent Per Second</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\TCPv4\Segments Sent/sec&quot;,300]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{min({$SCOMMPWSOS_OS_TCPV4_STXS_NS})}&gt;={$SCOMMPWSOS_OS_TCPV4_STXS_TH}</expression>
                            <name>TCPv4 Segments Sent Per Second is too high</name>
                            <url>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.TCPv4.SegmentsSentPerSec&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.1.0.0</url>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <description>The threshold for the TCPv4\Segments Sent/sec performance counter has been exceeded.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TCPv6 Connection Failures</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\TCPv6\Connection Failures&quot;]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>TCPv6 Connections Established</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\TCPv6\Connections Established&quot;]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>TCPv6 Connections Reset</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\TCPv6\Connections Reset&quot;]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>TCPv6 Segments Received Per Second</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\TCPv6\Segments Received/sec&quot;,300]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{min({$SCOMMPWSOS_OS_TCPV6_SRXS_TH})}&gt;={$SCOMMPWSOS_OS_TCPV6_SRXS_TH}</expression>
                            <name>TCPv6 Segments Received Per Second</name>
                            <url>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.TCPv6.SegmentsReceivedPerSec&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.1.0.0</url>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <description>The threshold for the TCPv6\Segments Received/sec performance counter has been exceeded.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TCPv6 Segments Retransmitted Per Second</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\TCPv6\Segments Retransmitted/sec&quot;,300]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{min({$SCOMMPWSOS_OS_TCPV6_SRTXS_NS})}&gt;={$SCOMMPWSOS_OS_TCPV6_SRTXS_TH}</expression>
                            <name>TCPv6 Segments Retransmitted Per Second is too high</name>
                            <url>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.TCPv6.SegmentsRetransmittedPerSec&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.1.0.0</url>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <description>The threshold for the TCPv6\Segments Retransmitted/sec performance counter has been exceeded.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TCPv6 Segments Sent Per Second</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\TCPv6\Segments Sent/sec&quot;,300]</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{min({$SCOMMPWSOS_OS_TCPV6_STXS_NS})}&gt;={$SCOMMPWSOS_OS_TCPV6_STXS_TH}</expression>
                            <name>TCPv6 Segments Sent Per Second is too high</name>
                            <url>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.TCPv6.SegmentsSentPerSec&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.1.0.0</url>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <description>The threshold for the TCPv6\Segments Sent/sec performance counter has been exceeded.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Time Offset</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter_en[&quot;\Windows Time Service\Computed Time Offset&quot;,600]</key>
                    <delay>10m</delay>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1000</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{min({$SCOMMPWSOS_OS_WTSOFFSET_NS},{$SCOMMPWSOS_OS_WTSOFFSET_TH})}=0</expression>
                            <name>Time Accuracy Out of Range</name>
                            <priority>AVERAGE</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.TotalTimeOffset&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.1.0.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Computer Browser Service Start Type</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[Browser,startup]</key>
                    <delay>1d</delay>
                    <description>Helper to determine service start mode as most server OS have Browser set to disabled.</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service startup type</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1w</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Computer Browser Service Health</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[Browser]</key>
                    <delay>5m</delay>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ComputerbrowserServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>DHCP Client Service Health</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[Dhcp]</key>
                    <delay>5m</delay>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.DHCPClientServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0</expression>
                            <name>DHCP Service Stopped</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.DHCPClientServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>DNS Client Service Health</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[Dnscache]</key>
                    <delay>5m</delay>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.DNSClientServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0</expression>
                            <name>DNS Client Service Stopped</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.DNSClientServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Windows Event Log Service Health</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[EventLog]</key>
                    <delay>5m</delay>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.EventLogServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0</expression>
                            <name>Windows Event Log Service Stopped</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.EventLogServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Server Service Health</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[LanmanServer]</key>
                    <delay>5m</delay>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ServerServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0</expression>
                            <name>Windows Server Service Stopped</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ServerServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Workstation Service Health</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[LanmanWorkstation]</key>
                    <delay>5m</delay>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.WorkstationServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0</expression>
                            <name>Windows Workstation Service Stopped</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.WorkstationServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TCP/IP NetBIOS Service Health</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[lmhosts]</key>
                    <delay>5m</delay>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.TCPIPNetBiosHelperBrowserServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0</expression>
                            <name>TCP/IP NetBIOS Service Stopped</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.TCPIPNetBiosHelperBrowserServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Windows Firewall Service Health</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[MpsSvc]</key>
                    <delay>5m</delay>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.FirewallServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0</expression>
                            <name>Windows Firewall Service Stopped</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.FirewallServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Plug and Play Service Health</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[PlugPlay]</key>
                    <delay>5m</delay>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.PlugandPlayServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0</expression>
                            <name>Plug and Play Service Stopped</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.PlugandPlayServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>RPC Service Health</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[RpcSs]</key>
                    <delay>5m</delay>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.RPCServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0</expression>
                            <name>RPC Service Stopped</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.RPCServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Windows Defender Advanced Threat Protection Service Health</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[Sense]</key>
                    <delay>5m</delay>
                    <applications>
                        <application>
                            <name>Windows Defender</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                </item>
                <item>
                    <name>Windows Defender Antivirus Network Inspection Service Health</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[WdNisSvc]</key>
                    <delay>5m</delay>
                    <applications>
                        <application>
                            <name>Windows Defender</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                </item>
                <item>
                    <name>Windows Defender Antivirus Service Health</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[WinDefend]</key>
                    <delay>5m</delay>
                    <applications>
                        <application>
                            <name>Windows Defender</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Windows Remote Management Service Health</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.info[WinRM]</key>
                    <delay>5m</delay>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.WindowsRemoteManagementServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Windows service state</name>
                    </valuemap>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{min(10m)}&gt;0</expression>
                            <name>Windows Remote Management Service Stopped</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.WindowsRemoteManagementServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0&#13;
As this service is delay-start and requires .Net recompilations during updates, allow 10 minutes for restart.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Restart Pending Component Based Servicing</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.run[&quot;cmd /v:on /c reg query \&quot;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\RebootPending\&quot; ^&gt;nul 2^&gt;^&amp;1 ^&amp; echo !errorlevel!&quot;]</key>
                    <delay>1h</delay>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Restart Pending Windows Update</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.run[&quot;cmd /v:on /c reg query \&quot;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\RebootRequired\&quot; ^&gt;nul 2^&gt;^&amp;1 ^&amp; echo !errorlevel!&quot;]</key>
                    <delay>1h</delay>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Restart Pending File Rename Operations</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.run[&quot;cmd /v:on /c reg query \&quot;HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\&quot; /v PendingFileRenameOperations ^&gt;nul 2^&gt;^&amp;1 ^&amp; echo !errorlevel!&quot;]</key>
                    <delay>1h</delay>
                    <status>DISABLED</status>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>PowerShell Version Check</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.run[powershell $PSVersionTable.PSVersion.Major]</key>
                    <delay>1d</delay>
                    <description>Check for required PowerShell version, we need at least PowerShell/WMF 3.0.</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;3</expression>
                            <name>Upgrade PowerShell to at least WMF3.0</name>
                            <priority>AVERAGE</priority>
                            <description>Some checks and discoveries do not work with less than PowerShell/WMF 3.0.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Windows Server Operating System BPA Monitor</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.run[powershell (Get-BpaModel^|Get-BpaResult 2^&gt;$nul^|? severity -eq error^|? excluded -ne $true^|measure).count]</key>
                    <delay>1d</delay>
                    <status>DISABLED</status>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.Monitoring.BPA.OperatingSystem.Monitor&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;0</expression>
                            <name>Operating System is not compliant with Best Practices Analyzer</name>
                            <priority>WARNING</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.Monitoring.BPA.OperatingSystem.Monitor&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>System information</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.uname</key>
                    <delay>1d</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Just to get basic OS telemetry</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>System uptime</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.uptime</key>
                    <units>uptime</units>
                    <description>Basic system telemetry</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Windows Activation</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,select licensestatus from softwarelicensingproduct where applicationID='55c92734-d682-4d71-983e-d6ec3f16059f' and licensestatus=1]</key>
                    <delay>1d</delay>
                    <status>DISABLED</status>
                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.WindowsActivation&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.8.0</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;1</expression>
                            <name>Windows Required Activation</name>
                            <priority>AVERAGE</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.WindowsActivation&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of Logical Processors</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,Select NumberOfLogicalProcessors from Win32_ComputerSystem]</key>
                    <delay>1d</delay>
                    <description>Helper for CPU usage trigger. Don't use builtin item as it might be used elsewhere.</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1w</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Total Physical Memory</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,Select TotalPhysicalMemory from Win32_ComputerSystem]</key>
                    <delay>1d</delay>
                    <units>B</units>
                    <description>Helper for Percent Memory Used.&#13;
TotalPhysicalMemory should return OS usable memory (eg it already excludes BIOS reserved memory etc).</description>
                    <applications>
                        <application>
                            <name>Operating System</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Windows Server Logical Disk</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.getall[root\cimv2,SELECT * FROM Win32_Volume WHERE NOT Name LIKE '\\\\?\\Volume{%' AND (DriveType=3 OR DriveType=6)]</key>
                    <delay>1d</delay>
                    <description>Uses Win32_Volume for discovery as LogicalDisk doesn't have enough information. Skips volumes without mount point, such as boot volume as it's very hard to map it to correct PerfMon path (HardDiskVolume…) - these volumes are usually boot or recovery ones and their performance doesn't matter. Preprocessing fixes JSON syntax (double escaping backslashes)&#13;
https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk&amp;Type=ClassType&amp;ManagementPack=Microsoft.Windows.Server.2016.Discovery&amp;Version=10.0.8.0</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>NTFS File System Corrupt {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>eventlog[System, {#I} \(,,Microsoft-Windows-Ntfs,^98$,,skip]</key>
                            <delay>1h</delay>
                            <trends>0</trends>
                            <value_type>LOG</value_type>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{nodata(24h)}=0 and {regexp(healthy\.)}=0</expression>
                                    <name>NTFS File System Corrupt {#I}</name>
                                    <priority>WARNING</priority>
                                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.NTFSFileSystemCorrupt.Alert&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.1.0.0</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Free Space (%) {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\% Free Space&quot;,900]</key>
                            <delay>15m</delay>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.PercentageFreeSpace&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1w</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&lt;{$SCOMMPWSOS_LDISK_FREEPER_ERR_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&gt;({$SCOMMPWSOS_LDISK_FREEPER_ERR_TH}*{$SCOMMPWSOS_LDISK_FREEPER_ERR_RE})</recovery_expression>
                                    <name>Logical Disk Percentage Free Space is low {#I}</name>
                                    <status>DISABLED</status>
                                    <priority>HIGH</priority>
                                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.PercentageFreeSpace&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&lt;{$SCOMMPWSOS_LDISK_FREEPER_WAR_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&gt;({$SCOMMPWSOS_LDISK_FREEPER_WAR_TH}*{$SCOMMPWSOS_LDISK_FREEPER_WAR_RE})</recovery_expression>
                                    <name>Logical Disk Percentage Free Space is low {#I}</name>
                                    <status>DISABLED</status>
                                    <priority>WARNING</priority>
                                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.PercentageFreeSpace&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0&#13;
Unlike original check, all disks are considered the same.</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Percent Idle Time {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\% Idle Time&quot;,900]</key>
                            <delay>15m</delay>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.PercentIdleTime&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{max({$SCOMMPWSOS_LDISK_PERCIT_NS})}&lt;{$SCOMMPWSOS_LDISK_PERCIT_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{max({$SCOMMPWSOS_LDISK_PERCIT_NS})}&gt;({$SCOMMPWSOS_LDISK_PERCIT_TH}*{$SCOMMPWSOS_LDISK_PERCIT_RE})</recovery_expression>
                                    <name>Logical disk idle time percentage is too low {#I}</name>
                                    <status>DISABLED</status>
                                    <priority>WARNING</priority>
                                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.PercentIdleTime&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Average Queue Length {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\Avg. Disk Queue Length&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.AverageDiskReadQueueLength.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Average Read Queue Length {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\Avg. Disk Read Queue Length&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.AverageDiskReadQueueLength.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Average Seconds Per Read {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\Avg. Disk sec/Read&quot;,60]</key>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>s</units>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.AvgDiskSecPerRead.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min({$SCOMMPWSOS_LDISK_ADISK_SR_NS})}&gt;{$SCOMMPWSOS_LDISK_ADISK_SR_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{min({$SCOMMPWSOS_LDISK_ADISK_SR_NS})}&lt;({$SCOMMPWSOS_LDISK_ADISK_SR_TH}/{$SCOMMPWSOS_LDISK_ADISK_SR_RE})</recovery_expression>
                                    <name>Logical Disk read latency is too high {#I}</name>
                                    <priority>WARNING</priority>
                                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.AvgDiskSecPerRead&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Average Seconds Per Transfer {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\Avg. Disk sec/Transfer&quot;,60]</key>
                            <value_type>FLOAT</value_type>
                            <units>s</units>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.AvgDiskSecPerWrite.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min({$SCOMMPWSOS_LDISK_ADISK_ST_NS})}&gt;{$SCOMMPWSOS_LDISK_ADISK_ST_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{min({$SCOMMPWSOS_LDISK_ADISK_ST_NS})}&lt;({$SCOMMPWSOS_LDISK_ADISK_ST_TH}/{$SCOMMPWSOS_LDISK_ADISK_ST_RE})</recovery_expression>
                                    <name>Logical disk transfer latency is too high {#I}</name>
                                    <priority>WARNING</priority>
                                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.AvgDiskSecPerTransfer&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Average Seconds Per Write {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\Avg. Disk sec/Write&quot;,60]</key>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>s</units>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.AvgDiskSecPerWrite.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min({$SCOMMPWSOS_LDISK_ADISK_SW_NS})}&lt;{$SCOMMPWSOS_LDISK_ADISK_SW_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{min({$SCOMMPWSOS_LDISK_ADISK_SW_NS})}&gt;({$SCOMMPWSOS_LDISK_ADISK_SW_TH}/{$SCOMMPWSOS_LDISK_ADISK_SW_RE})</recovery_expression>
                                    <name>Logical Disk write latency is too high {#I}</name>
                                    <status>DISABLED</status>
                                    <priority>WARNING</priority>
                                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.AvgDiskSecPerWrite&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Average Write Queue Length {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\Avg. Disk Write Queue Length&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.AverageDiskWriteQueueLength.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Current Queue Length {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\Current Disk Queue Length&quot;,300]</key>
                            <delay>5m</delay>
                            <value_type>FLOAT</value_type>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.CurrentDiskQueueLength&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min({$SCOMMPWSOS_LDISK_CDQL_NS})}&gt;{$SCOMMPWSOS_LDISK_CDQL_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{min({$SCOMMPWSOS_LDISK_CDQL_NS})}&lt;({$SCOMMPWSOS_LDISK_CDQL_TH}/{$SCOMMPWSOS_LDISK_CDQL_RE})</recovery_expression>
                                    <name>Logical disk current queue length is too high {#I}</name>
                                    <priority>WARNING</priority>
                                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.CurrentDiskQueueLength&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Total Bytes Per Second {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\Disk Bytes/sec&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>Bps</units>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.DiskBytesPerSec.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Read Bytes Per Second {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\Disk Read Bytes/sec&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>Bps</units>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.DiskReadBytesPerSec.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Reads Per Second {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\Disk Reads/sec&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.DiskReadsPerSec.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Write Bytes Per Second {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\Disk Write Bytes/sec&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>Bps</units>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.DiskWriteBytesPerSec.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Writes Per Second {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\Disk Writes/sec&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.DiskWritesPerSec.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Free Space (MB) {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\Free Megabytes&quot;]</key>
                            <delay>15m</delay>
                            <units>B</units>
                            <description>Item needs to be INT with  no aggeration as float overflows with 1TB+&#13;
https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.MBFreeSpace&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1048576</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&lt;{$SCOMMPWSOS_LDISK_FREEMB_ERR_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&gt;({$SCOMMPWSOS_LDISK_FREEMB_ERR_TH}*{$SCOMMPWSOS_LDISK_FREEMB_ERR_RE})</recovery_expression>
                                    <name>Logical Disk Free Space in MBytes is low {#I}</name>
                                    <status>DISABLED</status>
                                    <priority>HIGH</priority>
                                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.MBFreeSpace&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&lt;{$SCOMMPWSOS_LDISK_FREEMB_WAR_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&gt;({$SCOMMPWSOS_LDISK_FREEMB_WAR_TH}*{$SCOMMPWSOS_LDISK_FREEMB_WAR_RE})</recovery_expression>
                                    <name>Logical Disk Free Space in MBytes is low {#I}</name>
                                    <status>DISABLED</status>
                                    <priority>WARNING</priority>
                                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.MBFreeSpace&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Split I/O Per Second {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\LogicalDisk({#I})\Split IO/Sec&quot;,600]</key>
                            <delay>10m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.SplitIOPerSec.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Defragmentation Thin Provisioning {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>system.run[&quot;for /f \&quot;tokens=3\&quot; %a in ('reg query HKLM\SOFTWARE\Microsoft\Dfrg\Statistics\Volume{#DEVICEIDGUID} /v HardwareIssue') do echo %a&quot;]</key>
                            <delay>1d</delay>
                            <status>DISABLED</status>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>HEX_TO_DECIMAL</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1w</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Defragmentation Fragmentation {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>system.run[&quot;for /f \&quot;tokens=3\&quot; %a in ('reg query HKLM\SOFTWARE\Microsoft\Dfrg\Statistics\Volume{#DEVICEIDGUID} /v LastRunPercentFragmentation') do echo %a&quot;]</key>
                            <delay>1d</delay>
                            <status>DISABLED</status>
                            <units>%</units>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>HEX_TO_DECIMAL</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1w</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk System Drive {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,Select BootVolume From Win32_Volume Where Name='{#NAME}']</key>
                            <delay>1d</delay>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>BOOL_TO_DECIMAL</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1w</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Logical Disk Size {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,Select Capacity From Win32_Volume Where Name='{#NAME}']</key>
                            <delay>1d</delay>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1w</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>File system error or corruption {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,Select DirtyBitSet From Win32_Volume Where Name='{#NAME}']</key>
                            <delay>1h</delay>
                            <applications>
                                <application>
                                    <name>Logical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>BOOL_TO_DECIMAL</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1d</params>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;0</expression>
                                    <name>File system error or corruption {#I}</name>
                                    <url>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalDisk.AvailabilityHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.1.0.0</url>
                                    <priority>HIGH</priority>
                                    <description>NTFS reported the logical disk is in error or corrupt.&#13;
NTFS on the logical disk {#I} has reported that some portion of the file system is in error or is corrupted. This dirty bit has been set for the logical disk. In most cases running the CHKDSK utility will address the problem. Refer to the product knowledge for more complete guidance.</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>(&#13;
	{SCOM MP Windows Server Operating System:system.run[&quot;for /f \&quot;tokens=3\&quot; %a in ('reg query HKLM\SOFTWARE\Microsoft\Dfrg\Statistics\Volume{#DEVICEIDGUID} /v HardwareIssue') do echo %a&quot;].last()} &lt;&gt; 0&#13;
	and&#13;
	{SCOM MP Windows Server Operating System:system.run[&quot;for /f \&quot;tokens=3\&quot; %a in ('reg query HKLM\SOFTWARE\Microsoft\Dfrg\Statistics\Volume{#DEVICEIDGUID} /v HardwareIssue') do echo %a&quot;].last()} &lt;&gt; 4&#13;
	and&#13;
	{SCOM MP Windows Server Operating System:system.run[&quot;for /f \&quot;tokens=3\&quot; %a in ('reg query HKLM\SOFTWARE\Microsoft\Dfrg\Statistics\Volume{#DEVICEIDGUID} /v LastRunPercentFragmentation') do echo %a&quot;].last()} &gt; {$SCOMMPWSOS_LDISK_FPERCFRAG_TH}&#13;
)&#13;
or&#13;
(&#13;
	(&#13;
		{SCOM MP Windows Server Operating System:system.run[&quot;for /f \&quot;tokens=3\&quot; %a in ('reg query HKLM\SOFTWARE\Microsoft\Dfrg\Statistics\Volume{#DEVICEIDGUID} /v HardwareIssue') do echo %a&quot;].last()}=0&#13;
		or&#13;
		{SCOM MP Windows Server Operating System:system.run[&quot;for /f \&quot;tokens=3\&quot; %a in ('reg query HKLM\SOFTWARE\Microsoft\Dfrg\Statistics\Volume{#DEVICEIDGUID} /v HardwareIssue') do echo %a&quot;].last()}=4&#13;
	)&#13;
	and&#13;
	{SCOM MP Windows Server Operating System:system.run[&quot;for /f \&quot;tokens=3\&quot; %a in ('reg query HKLM\SOFTWARE\Microsoft\Dfrg\Statistics\Volume{#DEVICEIDGUID} /v LastRunPercentFragmentation') do echo %a&quot;].last()} &lt; {$SCOMMPWSOS_LDISK_FPERCTHE_TH}&#13;
	and&#13;
	{SCOM MP Windows Server Operating System:system.run[&quot;for /f \&quot;tokens=3\&quot; %a in ('reg query HKLM\SOFTWARE\Microsoft\Dfrg\Statistics\Volume{#DEVICEIDGUID} /v LastRunPercentFragmentation') do echo %a&quot;].last()}&lt;&gt;0&#13;
)</expression>
                            <name>Logical Disk Fragmentation Level is high {#I}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>({SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\% Free Space&quot;,900].last()}&lt;{$SCOMMPWSOS_LDISK_FREEPER_ERR_TH} and {SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\Free Megabytes&quot;].last()}&lt;{$SCOMMPWSOS_LDISK_FREEMB_ERR_TH})</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>({SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\% Free Space&quot;,900].last()}&gt;({$SCOMMPWSOS_LDISK_FREEPER_ERR_TH}*{$SCOMMPWSOS_LDISK_FREEMB_ERR_RE}) and {SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\Free Megabytes&quot;].last()}&gt;({$SCOMMPWSOS_LDISK_FREEMB_ERR_TH}*{$SCOMMPWSOS_LDISK_FREEMB_ERR_RE}))</recovery_expression>
                            <name>Logical Disk Free Space is low {#I}</name>
                            <status>DISABLED</status>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.Legacy.LogicalDisk.FreeSpace.Monitor&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0&#13;
Unlike original check, all disks are considered the same.</description>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>(&#13;
	{SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select BootVolume From Win32_Volume Where Name='{#NAME}'].last()}=1&#13;
	and&#13;
	{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\Free Megabytes&quot;].last()} &lt; ( {$SCOMMPWSOS_LDISK_FREEMB_SYS_ERR_TH} + ( {$SCOMMPWSOS_LDISK_FREEMB_SYS_ERR_SMP} * {SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select Capacity From Win32_Volume Where Name='{#NAME}'].last()} ) )&#13;
	and&#13;
	{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\% Free Space&quot;,900].last()} &lt; {$SCOMMPWSOS_LDISK_FREEPR_SYS_ERR_TH}&#13;
)&#13;
or&#13;
(&#13;
	{SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select BootVolume From Win32_Volume Where Name='{#NAME}'].last()}=0&#13;
	and&#13;
	{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\Free Megabytes&quot;].last()} &lt; ( {$SCOMMPWSOS_LDISK_FREEMB_NSYS_ERR_TH} + ( {$SCOMMPWSOS_LDISK_FREEMB_NSYS_ERR_SMP} * {SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select Capacity From Win32_Volume Where Name='{#NAME}'].last()} ) )&#13;
	and&#13;
	{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\% Free Space&quot;,900].last()} &lt; {$SCOMMPWSOS_LDISK_FREEPR_NSYS_ERR_TH}&#13;
)</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>(&#13;
	{SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select BootVolume From Win32_Volume Where Name='{#NAME}'].last()}=1&#13;
	and&#13;
	(&#13;
		{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\Free Megabytes&quot;].last()} &gt;= ( {$SCOMMPWSOS_LDISK_FREEMB_SYS_ERR_TH} + ( {$SCOMMPWSOS_LDISK_FREEMB_SYS_ERR_SMP} * {SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select Capacity From Win32_Volume Where Name='{#NAME}'].last()} ) ) * {$SCOMMPWSOS_LDISK_FREEMB_SYS_ERR_RE}&#13;
		or&#13;
		{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\% Free Space&quot;,900].last()} &gt;= {$SCOMMPWSOS_LDISK_FREEPR_SYS_ERR_TH} * {$SCOMMPWSOS_LDISK_FREEPR_SYS_ERR_RE}&#13;
	)&#13;
)&#13;
or&#13;
(&#13;
	{SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select BootVolume From Win32_Volume Where Name='{#NAME}'].last()}=0&#13;
	and&#13;
	(&#13;
		{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\Free Megabytes&quot;].last()} &gt;= ( {$SCOMMPWSOS_LDISK_FREEMB_NSYS_ERR_TH} + ( {$SCOMMPWSOS_LDISK_FREEMB_NSYS_ERR_SMP} * {SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select Capacity From Win32_Volume Where Name='{#NAME}'].last()} ) ) * {$SCOMMPWSOS_LDISK_FREEMB_NSYS_ERR_RE}&#13;
		or&#13;
		{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\% Free Space&quot;,900].last()} &gt;= {$SCOMMPWSOS_LDISK_FREEPR_NSYS_ERR_TH} * {$SCOMMPWSOS_LDISK_FREEPR_SYS_ERR_RE}&#13;
	)&#13;
)</recovery_expression>
                            <name>Logical Disk Free Space is low {#I}</name>
                            <priority>HIGH</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.Legacy.LogicalDisk.FreeSpace.Monitor&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.1.0.0&#13;
Unlike original trigger, a percentage of drive size (2.5 or 5) is added to MB threshold to make it more dynamic. Smaller disks will have relatively large MB threshold (at about 40GB, percent and MB will be equal at 10%/4GB), while large disk will have smaller MB thresholds, approaching percentage of drive size (2.5 or 5).</description>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>(&#13;
	{SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select BootVolume From Win32_Volume Where Name='{#NAME}'].last()}=1&#13;
	and&#13;
	{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\Free Megabytes&quot;].last()} &lt; ( {$SCOMMPWSOS_LDISK_FREEMB_SYS_WAR_TH} + ( {$SCOMMPWSOS_LDISK_FREEMB_SYS_WAR_SMP} * {SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select Capacity From Win32_Volume Where Name='{#NAME}'].last()} ) )&#13;
	and&#13;
	{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\% Free Space&quot;,900].last()} &lt; {$SCOMMPWSOS_LDISK_FREEPR_SYS_WAR_TH}&#13;
)&#13;
or&#13;
(&#13;
	{SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select BootVolume From Win32_Volume Where Name='{#NAME}'].last()}=0&#13;
	and&#13;
	{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\Free Megabytes&quot;].last()} &lt; ( {$SCOMMPWSOS_LDISK_FREEMB_NSYS_WAR_TH} + ( {$SCOMMPWSOS_LDISK_FREEMB_NSYS_WAR_SMP} * {SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select Capacity From Win32_Volume Where Name='{#NAME}'].last()} ) )&#13;
	and&#13;
	{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\% Free Space&quot;,900].last()}  &lt; {$SCOMMPWSOS_LDISK_FREEPR_NSYS_WAR_TH}&#13;
)</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>(&#13;
	{SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select BootVolume From Win32_Volume Where Name='{#NAME}'].last()}=1&#13;
	and&#13;
	(&#13;
		{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\Free Megabytes&quot;].last()} &gt;= ( {$SCOMMPWSOS_LDISK_FREEMB_SYS_WAR_TH} + ( {$SCOMMPWSOS_LDISK_FREEMB_SYS_WAR_SMP} * {SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select Capacity From Win32_Volume Where Name='{#NAME}'].last()} ) ) * {$SCOMMPWSOS_LDISK_FREEMB_SYS_WAR_RE}&#13;
		or&#13;
		{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\% Free Space&quot;,900].last()} &gt;= {$SCOMMPWSOS_LDISK_FREEPR_SYS_WAR_TH} * {$SCOMMPWSOS_LDISK_FREEPR_SYS_WAR_RE}&#13;
	)&#13;
)&#13;
or&#13;
(&#13;
	{SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select BootVolume From Win32_Volume Where Name='{#NAME}'].last()}=0&#13;
	and&#13;
	(&#13;
		{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\Free Megabytes&quot;].last()} &gt;= ( {$SCOMMPWSOS_LDISK_FREEMB_NSYS_WAR_TH} + ( {$SCOMMPWSOS_LDISK_FREEMB_NSYS_WAR_SMP} * {SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select Capacity From Win32_Volume Where Name='{#NAME}'].last()} ) ) * {$SCOMMPWSOS_LDISK_FREEMB_NSYS_WAR_RE}&#13;
		or&#13;
		{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\LogicalDisk({#I})\% Free Space&quot;,900].last()} &gt;= {$SCOMMPWSOS_LDISK_FREEPR_NSYS_WAR_TH} * {$SCOMMPWSOS_LDISK_FREEPR_SYS_WAR_RE}&#13;
	)&#13;
)</recovery_expression>
                            <name>Logical Disk Free Space is low {#I}</name>
                            <priority>WARNING</priority>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.Legacy.LogicalDisk.FreeSpace.Monitor&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.1.0.0&#13;
Unlike original trigger, a percentage of drive size (2.5 or 5) is added to MB threshold to make it more dynamic. Smaller disks will have relatively large MB threshold (at about 40GB, percent and MB will be equal at 10%/4GB), while large disk will have smaller MB thresholds, approaching percentage of drive size (2.5 or 5).</description>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Logical Disk Capacity {#I}</name>
                            <graph_items>
                                <graph_item>
                                    <color>199C0D</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\LogicalDisk({#I})\% Free Space&quot;,900]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\LogicalDisk({#I})\Free Megabytes&quot;]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>wmi.get[root\cimv2,Select Capacity From Win32_Volume Where Name='{#NAME}']</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>Logical Disk IOPS {#I}</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\LogicalDisk({#I})\Disk Reads/sec&quot;,300]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\LogicalDisk({#I})\Disk Writes/sec&quot;,300]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>Logical Disk Latency {#I}</name>
                            <graph_items>
                                <graph_item>
                                    <color>A54F10</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\LogicalDisk({#I})\Avg. Disk sec/Write&quot;,60]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>FC6EA3</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\LogicalDisk({#I})\Avg. Disk sec/Read&quot;,60]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>AC8C14</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\LogicalDisk({#I})\Avg. Disk sec/Transfer&quot;,60]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>Logical Disk Queue {#I}</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\LogicalDisk({#I})\Avg. Disk Write Queue Length&quot;,300]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\LogicalDisk({#I})\Avg. Disk Read Queue Length&quot;,300]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\LogicalDisk({#I})\Avg. Disk Queue Length&quot;,300]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>A54F10</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\LogicalDisk({#I})\Current Disk Queue Length&quot;,300]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>Logical Disk Throughput {#I}</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\LogicalDisk({#I})\Disk Bytes/sec&quot;,300]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\LogicalDisk({#I})\Disk Read Bytes/sec&quot;,300]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\LogicalDisk({#I})\Disk Write Bytes/sec&quot;,300]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <request_method>POST</request_method>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#DEVICEIDGUID}</lld_macro>
                            <path>$.DeviceIDGUID</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#I}</lld_macro>
                            <path>$.NamePerfmon</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#NAME}</lld_macro>
                            <path>$.Name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>parser = JSON.parse(value);
for (var i in parser) {
  parser[i]['NamePerfmon'] = parser[i]['Name'].replace(/\\+/g,'\\').replace(/\\$/g,'');
  parser[i]['DeviceIDGUID'] = parser[i]['DeviceID'].match('\{(.*?)\}')[0];
};
return JSON.stringify(parser);</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>2w</params>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <name>Windows Server Physical Disk</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.getall[root\cimv2,Select Name From Win32_PerfFormattedData_PerfDisk_PhysicalDisk where not name='_Total']</key>
                    <delay>1d</delay>
                    <description>Getas all physical disks, even offline ones.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Physical Disk Percent Idle Time {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#I})\% Idle Time&quot;,900]</key>
                            <delay>15m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <applications>
                                <application>
                                    <name>Physical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{max({$SCOMMPWSOS_PDISK_PERCIT_NS})}&lt;{$SCOMMPWSOS_PDISK_PERCIT_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{max({$SCOMMPWSOS_PDISK_PERCIT_NS})}&gt;({$SCOMMPWSOS_PDISK_PERCIT_TH}*{$SCOMMPWSOS_PDISK_PERCIT_RE})</recovery_expression>
                                    <name>Physical disk idle time percentage is too low {#I}</name>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk Average Queue Length {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Avg. Disk Queue Length&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>Physical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk Average Read Queue Length {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Avg. Disk Read Queue Length&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>Physical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk Average Seconds Per Read {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Avg. Disk sec/Read&quot;,60]</key>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>s</units>
                            <applications>
                                <application>
                                    <name>Physical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min({$SCOMMPWSOS_PDISK_ADISK_SR_NS})}&gt;{$SCOMMPWSOS_PDISK_ADISK_SR_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{min({$SCOMMPWSOS_PDISK_ADISK_SR_NS})}&lt;({$SCOMMPWSOS_PDISK_ADISK_SR_TH}/{$SCOMMPWSOS_PDISK_ADISK_SR_RE})</recovery_expression>
                                    <name>Phyiscal Disk read latency is too high {#I}</name>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk Average Seconds Per Transfer {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Avg. Disk sec/Transfer&quot;,60]</key>
                            <value_type>FLOAT</value_type>
                            <units>s</units>
                            <applications>
                                <application>
                                    <name>Physical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min({$SCOMMPWSOS_PDISK_ADISK_ST_NS})}&gt;{$SCOMMPWSOS_PDISK_ADISK_ST_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{min({$SCOMMPWSOS_PDISK_ADISK_ST_NS})}&lt;({$SCOMMPWSOS_PDISK_ADISK_ST_TH}/{$SCOMMPWSOS_PDISK_ADISK_ST_RE})</recovery_expression>
                                    <name>Physical disk transfer latency is too high {#I}</name>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk Average Seconds Per Write {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Avg. Disk sec/Write&quot;,60]</key>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>s</units>
                            <applications>
                                <application>
                                    <name>Physical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min({$SCOMMPWSOS_PDISK_ADISK_SW_NS})}&gt;{$SCOMMPWSOS_PDISK_ADISK_SW_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{min({$SCOMMPWSOS_PDISK_ADISK_SW_NS})}&lt;({$SCOMMPWSOS_PDISK_ADISK_SW_TH}/{$SCOMMPWSOS_PDISK_ADISK_SW_RE})</recovery_expression>
                                    <name>Phyiscal Disk write latency is too high {#I}</name>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk Average Write Queue Length {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Avg. Disk Write Queue Length&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>Physical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk Current Queue Length {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Current Disk Queue Length&quot;,300]</key>
                            <delay>5m</delay>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>Physical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min({$SCOMMPWSOS_PDISK_CDQL_NS})}&gt;{$SCOMMPWSOS_PDISK_CDQL_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{min({$SCOMMPWSOS_PDISK_CDQL_NS})}&lt;({$SCOMMPWSOS_PDISK_CDQL_TH}/{$SCOMMPWSOS_PDISK_CDQL_RE})</recovery_expression>
                                    <name>Physical disk current queue length is too high {#I}</name>
                                    <priority>WARNING</priority>
                                    <description>The threshold for the Physical Disk\Current Disk Queue Length performance counter has been exceeded</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Total Disk Bytes per Second {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Disk Bytes/sec&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>Bps</units>
                            <applications>
                                <application>
                                    <name>Physical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk Read Bytes Per Second {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Disk Read Bytes/sec&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Physical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk Reads per Second {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Disk Reads/sec&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>Physical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk Write Bytes Per Second {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Disk Write Bytes/sec&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Physical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk Writes per Second {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Disk Writes/sec&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>Physical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk Split I/O Per Second {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Split IO/Sec&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>Physical Disk</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Physical Disk IOPS {#I}</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Disk Reads/sec&quot;,300]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Disk Writes/sec&quot;,300]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>Physical Disk Latency {#I}</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Avg. Disk sec/Write&quot;,60]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Avg. Disk sec/Read&quot;,60]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Avg. Disk sec/Transfer&quot;,60]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>Physical Disk Queue {#I}</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Avg. Disk Write Queue Length&quot;,300]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Avg. Disk Read Queue Length&quot;,300]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Current Disk Queue Length&quot;,300]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>A54F10</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Avg. Disk Queue Length&quot;,300]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>Physical Disk Throughput {#I}</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Disk Read Bytes/sec&quot;,300]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Disk Bytes/sec&quot;,300]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\PhysicalDisk({#I})\Disk Write Bytes/sec&quot;,300]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <request_method>POST</request_method>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#I}</lld_macro>
                            <path>$.Name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
                <discovery_rule>
                    <name>Windows Server Logical Processor</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.getall[root\cimv2,select name from Win32_PerfRawData_PerfOS_Processor where not name='_Total']</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>CPU Percentage DPC Time {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\Processor({#I})\% DPC Time&quot;,120]</key>
                            <delay>2m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.Processor.PercentDPCTime&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Processor Information</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min({$SCOMMPWSOS_PROC_PERCDPCT_NS})}&gt;{$SCOMMPWSOS_PROC_PERCDPCT_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{min({$SCOMMPWSOS_PROC_PERCDPCT_NS})}&lt;({$SCOMMPWSOS_PROC_PERCDPCT_TH}/{$SCOMMPWSOS_PROC_PERCDPCT_RE})</recovery_expression>
                                    <name>DPC Time Critical {#I}</name>
                                    <status>DISABLED</status>
                                    <priority>HIGH</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>CPU Percentage Interrupt Time {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\Processor({#I})\% Interrupt Time&quot;,120]</key>
                            <delay>2m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.TotalPercentInterruptTime&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Processor Information</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min({$SCOMMPWSOS_PROC_PERCINTT_NS})}&gt;{$SCOMMPWSOS_PROC_PERCINTT_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{min({$SCOMMPWSOS_PROC_PERCINTT_NS})}&lt;({$SCOMMPWSOS_PROC_PERCINTT_TH}/{$SCOMMPWSOS_PROC_PERCINTT_RE})</recovery_expression>
                                    <name>Interrupt Time Critical {#I}</name>
                                    <status>DISABLED</status>
                                    <priority>HIGH</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>CPU Percentage Utilization {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\Processor({#I})\% Processor Time&quot;,120]</key>
                            <delay>2m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.LogicalProcessor.PercentProcessorTime.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Processor Information</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min({$SCOMMPWSOS_PROC_PERCPROCT_NS})}&gt;{$SCOMMPWSOS_PROC_PERCPROCT_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{min({$SCOMMPWSOS_PROC_PERCPROCT_NS})}&lt;({$SCOMMPWSOS_PROC_PERCPROCT_TH}/{$SCOMMPWSOS_PROC_PERCPROCT_RE})</recovery_expression>
                                    <name>CPU Utilization High {#I}</name>
                                    <status>DISABLED</status>
                                    <priority>HIGH</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>CPU Performance {#I}</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\Processor({#I})\% DPC Time&quot;,120]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\Processor({#I})\% Interrupt Time&quot;,120]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\Processor({#I})\% Processor Time&quot;,120]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <request_method>POST</request_method>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#I}</lld_macro>
                            <path>$.Name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
                <discovery_rule>
                    <name>Windows Server Network Adapter</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.getall[root\StandardCimv2,select interfacedescription from msft_netadapter where hardwareinterface = 'true']</key>
                    <delay>1d</delay>
                    <description>Default instances have many nonexistent adapters, causing unnecessary hits. We can't use Name directly as some characters are replaced for performance counter instance names. For example '#' becomes '_'.&#13;
&#13;
Does not work on earlier than WS2012</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Network Adapter Percent Bandwidth Used Read {#I}</name>
                            <type>CALCULATED</type>
                            <key>NetworkAdapterBytesReceivedPercent.[&quot;{#I}&quot;]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <params>100*last(&quot;perf_counter_en[\&quot;\Network Interface({#I})\Bytes Received/sec\&quot;,300]&quot;)/last(&quot;perf_counter_en[\&quot;\Network Interface({#I})\Current Bandwidth\&quot;,300]&quot;)</params>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.NetworkAdapter.PercentBandwidthUsedReads.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Network Interface</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min({$SCOMMPWSOS_NETADAP_PERCBWUR_NS})}&gt;{$SCOMMPWSOS_NETADAP_PERCBWUR_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{min({$SCOMMPWSOS_NETADAP_PERCBWUR_NS})}&lt;({$SCOMMPWSOS_NETADAP_PERCBWUR_TH} / {$SCOMMPWSOS_NETADAP_PERCBWUR_RE})</recovery_expression>
                                    <name>Used read bandwidth is over threshold {#I}</name>
                                    <priority>WARNING</priority>
                                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.NetworkAdapter.PercentBandwidthUsedReads&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Adapter Percent Bandwidth Used Write {#I}</name>
                            <type>CALCULATED</type>
                            <key>NetworkAdapterBytesSentPercent.[&quot;{#I}&quot;]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <params>100*last(&quot;perf_counter_en[\&quot;\Network Interface({#I})\Bytes Sent/sec\&quot;,300]&quot;)/last(&quot;perf_counter_en[\&quot;\Network Interface({#I})\Current Bandwidth\&quot;,300]&quot;)</params>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.NetworkAdapter.PercentBandwidthUsedWrites.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Network Interface</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min({$SCOMMPWSOS_NETADAP_PERCBWUW_NS})}&gt;{$SCOMMPWSOS_NETADAP_PERCBWUW_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{min({$SCOMMPWSOS_NETADAP_PERCBWUW_NS})}&lt;({$SCOMMPWSOS_NETADAP_PERCBWUW_TH}/{$SCOMMPWSOS_NETADAP_PERCBWUW_RE})</recovery_expression>
                                    <name>Used write bandwidth is over threshold {#I}</name>
                                    <priority>WARNING</priority>
                                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.NetworkAdapter.PercentBandwidthUsedWrites&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Adapter Percent Bandwidth Used Total {#I}</name>
                            <type>CALCULATED</type>
                            <key>NetworkAdapterBytesTotalPercent.[&quot;{#I}&quot;]</key>
                            <delay>5m</delay>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <params>100*last(&quot;perf_counter_en[\&quot;\Network Interface({#I})\Bytes Total/sec\&quot;,300]&quot;)/last(&quot;perf_counter_en[\&quot;\Network Interface({#I})\Current Bandwidth\&quot;,300]&quot;)</params>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.NetworkAdapter.PercentBandwidthUsedReads.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Network Interface</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min({$SCOMMPWSOS_NETADAP_PERCBWUT_NS})}&gt;{$SCOMMPWSOS_NETADAP_PERCBWUT_TH}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{min({$SCOMMPWSOS_NETADAP_PERCBWUT_NS})}&lt;({$SCOMMPWSOS_NETADAP_PERCBWUT_TH} /{$SCOMMPWSOS_NETADAP_PERCBWUT_RE})</recovery_expression>
                                    <name>Used total bandwidth is over threshold {#I}</name>
                                    <priority>WARNING</priority>
                                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.NetworkAdapter.PercentBandwidthUsedTotal&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Adapter Bytes Receiced Per Sec {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\Network Interface({#I})\Bytes Received/sec&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>Bps</units>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.NetworkAdapter.BytesReceivedPerSec.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Network Interface</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Adapter Bytes Sent Per Sec {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\Network Interface({#I})\Bytes Sent/sec&quot;,300]</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <value_type>FLOAT</value_type>
                            <units>Bps</units>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.NetworkAdapter.BytesSentPerSec.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Network Interface</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Adapter Bytes Total Per Sec {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\Network Interface({#I})\Bytes Total/sec&quot;,300]</key>
                            <delay>5m</delay>
                            <value_type>FLOAT</value_type>
                            <units>Bps</units>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.NetworkAdapter.BytesTotalPerSec.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Network Interface</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Adapter Current Bandwidth {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\Network Interface({#I})\Current Bandwidth&quot;]</key>
                            <delay>10m</delay>
                            <units>Bps</units>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.NetworkAdapter.CurrentBandwidth.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Network Interface</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>0.125</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Adapter Output Queue Length {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>perf_counter_en[&quot;\Network Interface({#I})\Output Queue Length&quot;,300]</key>
                            <delay>5m</delay>
                            <value_type>FLOAT</value_type>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.NetworkAdapter.OutputQueueLength.Collection&amp;Type=Rule&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Network Interface</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Adapter Connection Health {#I}</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,Select NetConnectionStatus from Win32_NetworkAdapter Where Name='{#N}']</key>
                            <delay>5m</delay>
                            <status>DISABLED</status>
                            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.NetworkAdapter.NetworkAdapterConnectionHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                            <applications>
                                <application>
                                    <name>Network Interface</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>1h</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&lt;&gt;2</expression>
                                    <name>Network Adapter Disconnected {#I}</name>
                                    <priority>HIGH</priority>
                                    <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.NetworkAdapter.NetworkAdapterConnectionHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Network Adapter Throughput % {#I}</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>NetworkAdapterBytesReceivedPercent.[&quot;{#I}&quot;]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>NetworkAdapterBytesTotalPercent.[&quot;{#I}&quot;]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>NetworkAdapterBytesSentPercent.[&quot;{#I}&quot;]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>Network Adapter Throughput Bytes {#I}</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\Network Interface({#I})\Bytes Received/sec&quot;,300]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\Network Interface({#I})\Bytes Sent/sec&quot;,300]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\Network Interface({#I})\Bytes Total/sec&quot;,300]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>A54F10</color>
                                    <item>
                                        <host>SCOM MP Windows Server Operating System</host>
                                        <key>perf_counter_en[&quot;\Network Interface({#I})\Current Bandwidth&quot;]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <request_method>POST</request_method>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#I}</lld_macro>
                            <path>$.NamePerfmon</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#N}</lld_macro>
                            <path>$.InterfaceDescription</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>parser = JSON.parse(value);
 for (var i in parser) {
  parser[i]['NamePerfmon'] = parser[i]['InterfaceDescription'].replace('#','_').replace('(','[').replace(')',']');
 };
return JSON.stringify(parser);</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>2w</params>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_ADISK_SR_NS}</macro>
                    <value>#15</value>
                    <description>Logical Disk Average Disk Seconds per Read Trigger Number of samples - 15 samples * 1m frequency = 15 minutes</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_ADISK_SR_RE}</macro>
                    <value>2</value>
                    <description>Logical Disk Average Disk Seconds per Read Trigger Recovery multiplier</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_ADISK_SR_TH}</macro>
                    <value>0.04</value>
                    <description>Logical Disk Average Disk Seconds per Read Trigger Threshold - 0.04 minutes = 40ms</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_ADISK_ST_NS}</macro>
                    <value>#15</value>
                    <description>Logical Disk Average Disk Seconds per Transfer Number of samples - 15 samples * 1m frequency = 15 minutes</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_ADISK_ST_RE}</macro>
                    <value>2</value>
                    <description>Logical Disk Average Disk Seconds per Transfer Trigger Recovery multiplier</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_ADISK_ST_TH}</macro>
                    <value>0.04</value>
                    <description>Logical Disk Average Disk Seconds per Transfer Trigger Threshold - 0.04 minutes = 40ms</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_ADISK_SW_NS}</macro>
                    <value>#15</value>
                    <description>Logical Disk Average Disk Seconds per Write Number of samples - 15 samples * 1m frequency = 15 minutes</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_ADISK_SW_RE}</macro>
                    <value>2</value>
                    <description>Logical Disk Average Disk Seconds per Write Trigger Recovery multiplier</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_ADISK_SW_TH}</macro>
                    <value>0.04</value>
                    <description>Logical Disk Average Disk Seconds per Write Trigger Threshold - 0.04 minutes = 40ms</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_CDQL_NS}</macro>
                    <value>#12</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_CDQL_RE}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_CDQL_TH}</macro>
                    <value>32</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FPERCFRAG_TH}</macro>
                    <value>20</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FPERCTHE_TH}</macro>
                    <value>50</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_ERR_RE}</macro>
                    <value>1.5</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_ERR_TH}</macro>
                    <value>1000</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_NSYS_ERR_RE}</macro>
                    <value>1.2</value>
                    <description>Logical Disk Free Space (MB) Non-System Disk Error Recovery Multiplier</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_NSYS_ERR_SMP}</macro>
                    <value>0.025</value>
                    <description>Logical Disk Free Space (MB) Non-System Disk Error Threshold Size Multiplier - 2.5%</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_NSYS_ERR_TH}</macro>
                    <value>1073741824</value>
                    <description>Logical Disk Free Space (MB) Non-System Disk Error Threshold - 1GiB</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_NSYS_WAR_RE}</macro>
                    <value>1.2</value>
                    <description>Logical Disk Free Space (MB) Non-System Disk Warning Recovery Multiplier</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_NSYS_WAR_SMP}</macro>
                    <value>0.05</value>
                    <description>Logical Disk Free Space (MB) Non-System Disk Warning Threshold Size Multiplier - 5%</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_NSYS_WAR_TH}</macro>
                    <value>2147483648</value>
                    <description>Logical Disk Free Space (MB) Non-System Disk Warning Threshold - 2GiB</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_SYS_ERR_RE}</macro>
                    <value>1.2</value>
                    <description>Logical Disk Free Space (MB) System Disk Error Recovery Multiplier</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_SYS_ERR_SMP}</macro>
                    <value>0.025</value>
                    <description>Logical Disk Free Space (MB) System Disk Error Threshold Size Multiplier - 2.5%</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_SYS_ERR_TH}</macro>
                    <value>314572800</value>
                    <description>Logical Disk Free Space (MB) System Disk Error Threshold - 300MiB</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_SYS_WAR_RE}</macro>
                    <value>1.2</value>
                    <description>Logical Disk Free Space (MB) System Disk Warning Recovery Multiplier</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_SYS_WAR_SMP}</macro>
                    <value>0.05</value>
                    <description>Logical Disk Free Space (MB) System Disk Warning Threshold Size Multiplier - 5%</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_SYS_WAR_TH}</macro>
                    <value>536870912</value>
                    <description>Logical Disk Free Space (MB) System Disk Warning Threshold - 0.5GiB</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_WAR_RE}</macro>
                    <value>1.5</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEMB_WAR_TH}</macro>
                    <value>2000</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEPER_ERR_RE}</macro>
                    <value>1.5</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEPER_ERR_TH}</macro>
                    <value>5</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEPER_WAR_RE}</macro>
                    <value>1.5</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEPER_WAR_TH}</macro>
                    <value>10</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEPR_NSYS_ERR_RE}</macro>
                    <value>1.2</value>
                    <description>Logical Disk Free Space % Non-System Disk Error Recovery Multiplier</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEPR_NSYS_ERR_TH}</macro>
                    <value>5</value>
                    <description>Logical Disk Free Space % Non-System Disk Error Threshold</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEPR_NSYS_WAR_RE}</macro>
                    <value>1.2</value>
                    <description>Logical Disk Free Space % Non-System Disk Warning Recovery Multiplier</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEPR_NSYS_WAR_TH}</macro>
                    <value>10</value>
                    <description>Logical Disk Free Space % Non-System Disk Warning Threshold</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEPR_SYS_ERR_RE}</macro>
                    <value>1.2</value>
                    <description>Logical Disk Free Space % System Disk Error Recovery Multiplier</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEPR_SYS_ERR_TH}</macro>
                    <value>5</value>
                    <description>Logical Disk Free Space % System Disk Error Threshold</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEPR_SYS_WAR_RE}</macro>
                    <value>1.2</value>
                    <description>Logical Disk Free Space % System Disk Warning Recovery Multiplier</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_FREEPR_SYS_WAR_TH}</macro>
                    <value>10</value>
                    <description>Logical Disk Free Space % System Disk Warning Threshjold</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_PERCIT_NS}</macro>
                    <value>24</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_PERCIT_RE}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_LDISK_PERCIT_TH}</macro>
                    <value>20</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_NETADAP_PERCBWUR_NS}</macro>
                    <value>#12</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_NETADAP_PERCBWUR_RE}</macro>
                    <value>1.5</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_NETADAP_PERCBWUR_TH}</macro>
                    <value>60</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_NETADAP_PERCBWUT_NS}</macro>
                    <value>#12</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_NETADAP_PERCBWUT_RE}</macro>
                    <value>1.5</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_NETADAP_PERCBWUT_TH}</macro>
                    <value>75</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_NETADAP_PERCBWUW_NS}</macro>
                    <value>#12</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_NETADAP_PERCBWUW_RE}</macro>
                    <value>1.5</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_NETADAP_PERCBWUW_TH}</macro>
                    <value>60</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_MAXCAPITO_RE}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_MAXCAPITO_TH}</macro>
                    <value>2000</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_MAXCAPIW_RE}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_MAXCAPIW_TH}</macro>
                    <value>50</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_MEMAMB_NS}</macro>
                    <value>#3</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_MEMAMB_RE}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_MEMAMB_TH}</macro>
                    <value>104857600</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_MEMPPS_NS}</macro>
                    <value>#12</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_MEMPPS_RE}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_MEMPPS_TH}</macro>
                    <value>5000</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_PERCMEMU_NS}</macro>
                    <value>#3</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_PERCMEMU_RE}</macro>
                    <value>0.9</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_PERCMEMU_TH}</macro>
                    <value>90</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_TCPV4_SRTXS_NS}</macro>
                    <value>12</value>
                    <description>TCPv4 Segments Retransmitted Per Second Number of Samples</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_TCPV4_SRTXS_TH}</macro>
                    <value>10</value>
                    <description>TCPv4 Segments Retransmitted Per Second Threshold</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_TCPV4_SRXS_NS}</macro>
                    <value>12</value>
                    <description>TCPv4 Segments Received Per Second Number of Samples</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_TCPV4_SRXS_TH}</macro>
                    <value>100</value>
                    <description>TCPv4 Segments Received Per Second Threshold</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_TCPV4_STXS_NS}</macro>
                    <value>12</value>
                    <description>TCPv4 Segments Sent Per Second Number of Samples</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_TCPV4_STXS_TH}</macro>
                    <value>100</value>
                    <description>TCPv4 Segments Sent Per Second Threshold</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_TCPV6_SRTXS_NS}</macro>
                    <value>12</value>
                    <description>TCPv6 Segments Retransmitted Per Second Number of Samples</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_TCPV6_SRTXS_TH}</macro>
                    <value>10</value>
                    <description>TCPv6 Segments Retransmitted Per Second Threshold</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_TCPV6_SRXS_NS}</macro>
                    <value>12</value>
                    <description>TCPv6 Segments Received Per Second Number of Samples</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_TCPV6_SRXS_TH}</macro>
                    <value>100</value>
                    <description>TCPv6 Segments Received Per Second Threshold</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_TCPV6_STXS_NS}</macro>
                    <value>12</value>
                    <description>TCPv6 Segments Sent Per Second Number of Samples</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_TCPV6_STXS_TH}</macro>
                    <value>100</value>
                    <description>TCPv6 Segments Sent Per Second Threshold</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_WTSOFFSET_NS}</macro>
                    <value>#4</value>
                    <description>Operating System Windows Time Service Computed Time Offset Number of samples</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_OS_WTSOFFSET_TH}</macro>
                    <value>60</value>
                    <description>Operating System Windows Time Service Computed Time Offset Threshold - 60 seconds</description>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PDISK_ADISK_SR_NS}</macro>
                    <value>#15</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PDISK_ADISK_SR_RE}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PDISK_ADISK_SR_TH}</macro>
                    <value>0.04</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PDISK_ADISK_ST_NS}</macro>
                    <value>#15</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PDISK_ADISK_ST_RE}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PDISK_ADISK_ST_TH}</macro>
                    <value>0.04</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PDISK_ADISK_SW_NS}</macro>
                    <value>#15</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PDISK_ADISK_SW_RE}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PDISK_ADISK_SW_TH}</macro>
                    <value>0.04</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PDISK_CDQL_NS}</macro>
                    <value>#12</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PDISK_CDQL_RE}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PDISK_CDQL_TH}</macro>
                    <value>32</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PDISK_PERCIT_NS}</macro>
                    <value>#24</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PDISK_PERCIT_RE}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PDISK_PERCIT_TH}</macro>
                    <value>20</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PROC_PERCDPCT_NS}</macro>
                    <value>#5</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PROC_PERCDPCT_RE}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PROC_PERCDPCT_TH}</macro>
                    <value>15</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PROC_PERCINTT_NS}</macro>
                    <value>#5</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PROC_PERCINTT_RE}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PROC_PERCINTT_TH}</macro>
                    <value>10</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PROC_PERCPROCT_NS}</macro>
                    <value>#5</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PROC_PERCPROCT_RE}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$SCOMMPWSOS_PROC_PERCPROCT_TH}</macro>
                    <value>95</value>
                </macro>
            </macros>
            <screens>
                <screen>
                    <name>Logical disk performance</name>
                    <hsize>1</hsize>
                    <vsize>4</vsize>
                    <screen_items>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Logical Disk IOPS {#I}</name>
                                <host>SCOM MP Windows Server Operating System</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>1</valign>
                            <halign>1</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Logical Disk Latency {#I}</name>
                                <host>SCOM MP Windows Server Operating System</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>1</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>1</valign>
                            <halign>1</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Logical Disk Queue {#I}</name>
                                <host>SCOM MP Windows Server Operating System</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>2</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>1</valign>
                            <halign>1</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Logical Disk Throughput {#I}</name>
                                <host>SCOM MP Windows Server Operating System</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>3</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>1</valign>
                            <halign>1</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                    </screen_items>
                </screen>
            </screens>
        </template>
    </templates>
    <triggers>
        <trigger>
            <expression>({SCOM MP Windows Server Operating System:service.info[Browser].last()}&lt;&gt;0 and {SCOM MP Windows Server Operating System:service.info[Browser,startup].last()}&lt;2)</expression>
            <name>Computer Browser Service Stopped</name>
            <priority>HIGH</priority>
            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.ComputerbrowserServiceHealth&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
            <manual_close>YES</manual_close>
        </trigger>
        <trigger>
            <expression>{SCOM MP Windows Server Operating System:eventlog[System,,,EventLog,6008,,skip].nodata(24h)}=0 or {SCOM MP Windows Server Operating System:eventlog[System,,,BugCheck,1000|1001,,skip].nodata(24h)}=0</expression>
            <name>Dirty shutdown</name>
            <priority>AVERAGE</priority>
            <description>Custom trigger to catch unexpected restarts.</description>
            <manual_close>YES</manual_close>
        </trigger>
        <trigger>
            <expression>({SCOM MP Windows Server Operating System:perf_counter_en[&quot;\Netlogon(_Total)\Semaphore Timeouts&quot;,900].last()}&gt;{$SCOMMPWSOS_OS_MAXCAPITO_TH} or {SCOM MP Windows Server Operating System:perf_counter_en[&quot;\Netlogon(_Total)\Semaphore Waiters&quot;,900].last()}&gt;{$SCOMMPWSOS_OS_MAXCAPIW_TH})</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>({SCOM MP Windows Server Operating System:perf_counter_en[&quot;\Netlogon(_Total)\Semaphore Timeouts&quot;,900].last()}&gt;({$SCOMMPWSOS_OS_MAXCAPITO_TH}/{$SCOMMPWSOS_OS_MAXCAPITO_RE}) or {SCOM MP Windows Server Operating System:perf_counter_en[&quot;\Netlogon(_Total)\Semaphore Waiters&quot;,900].last()}&gt;({$SCOMMPWSOS_OS_MAXCAPIW_TH}/{$SCOMMPWSOS_OS_MAXCAPIW_RE}))</recovery_expression>
            <name>Max Concurrent API Reached alert</name>
            <priority>AVERAGE</priority>
            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.MaxConcurrentAPI.Monitor&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0</description>
            <manual_close>YES</manual_close>
        </trigger>
        <trigger>
            <expression>{SCOM MP Windows Server Operating System:system.run[&quot;cmd /v:on /c reg query \&quot;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\RebootPending\&quot; ^&gt;nul 2^&gt;^&amp;1 ^&amp; echo !errorlevel!&quot;].last()}=0 or {SCOM MP Windows Server Operating System:system.run[&quot;cmd /v:on /c reg query \&quot;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\RebootRequired\&quot; ^&gt;nul 2^&gt;^&amp;1 ^&amp; echo !errorlevel!&quot;].last()}=0</expression>
            <name>Restart pending</name>
            <priority>WARNING</priority>
        </trigger>
        <trigger>
            <expression>{SCOM MP Windows Server Operating System:perf_counter_en[&quot;\Processor(_Total)\% Processor Time&quot;,120].min(30m)}&gt;95 and {SCOM MP Windows Server Operating System:perf_counter_en[&quot;\System\Processor Queue Length&quot;,120].min(30m)}&gt;({SCOM MP Windows Server Operating System:wmi.get[root\cimv2,Select NumberOfLogicalProcessors from Win32_ComputerSystem].last()}*15)</expression>
            <name>Total CPU Utilization Percentage is too high</name>
            <priority>HIGH</priority>
            <description>https://systemcenter.wiki/?GetElement=Microsoft.Windows.Server.10.0.OperatingSystem.TotalCPUUtilization&amp;Type=UnitMonitor&amp;ManagementPack=Microsoft.Windows.Server.2016.Monitoring&amp;Version=10.0.17.0&#13;
To understand this trigger, please read https://blogs.technet.microsoft.com/kevinholman/2017/05/13/how-does-cpu-monitoring-work-in-the-windows-server-2016-management-pack/</description>
            <manual_close>YES</manual_close>
        </trigger>
    </triggers>
    <value_maps>
        <value_map>
            <name>Windows service startup type</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Automatic</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Automatic delayed</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Manual</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>Disabled</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Unknown</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Windows service state</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Running</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Paused</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Start pending</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>Pause pending</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Continue pending</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>Stop pending</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>Stopped</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>Unknown</newvalue>
                </mapping>
                <mapping>
                    <value>255</value>
                    <newvalue>No such service</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
